(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var a=n(3),o=n.n(a),r=n(11),i=n.n(r),u=(n(18),n(0)),s=n(2),c=n(4),l=n(1),h=n(5),d=n(7),m=n(12),p=n(6),g=function(e){return o.a.createElement("div",{id:"controls"},o.a.createElement("div",{id:"grayscale-toggle",className:"control-item"},o.a.createElement("p",null,"Grayscale:"),o.a.createElement("input",{type:"checkbox",onChange:e.toggleGrayscale})),o.a.createElement("div",{id:"map-size-toggle",className:"control-item"},o.a.createElement("p",null,"Map size:"),o.a.createElement("input",{type:"range",min:"7",max:"9",value:e.n,onChange:function(t){return e.setN(t.target.value)}})),o.a.createElement("div",{id:"roughness-toggle",className:"control-item"},o.a.createElement("p",null,"Roughness:"),o.a.createElement("input",{type:"range",min:".1",max:".7",value:e.roughness,step:".1",onChange:function(t){return e.setRoughness(t.target.value)}})),o.a.createElement("div",{id:"zoom-slider",className:"control-item"},o.a.createElement("p",null,"Zoom:"),o.a.createElement("input",{type:"range",min:"2",max:"30",value:e.zoom,onChange:function(t){return e.setZoom(t.target.value)}})),o.a.createElement("button",{id:"generate-button",className:"control-item",disabled:e.isLoading,onClick:e.generateTerrain},"Generate Terrain"))},f=function(e){return o.a.createElement("div",{className:"loading-block loading-block-".concat(e.isLoading)},o.a.createElement("div",{id:"loading-image"},o.a.createElement("h1",null,"Loading...")))},v=new p.g(16777215,1,1e5);v.position.set(290,250,690),v.castShadow=!0;var M=new p.a(13421772),b=new p.h;b.add(v),b.add(M);var w=new p.j({antialias:!0});function z(e){var t=Object(a.useRef)(null),n=new p.e(e.zoom,t.clientWidth/t.clientHeight,.1,9e3);n.position.set(400,-100,740),n.up.set(1,0,0),n.lookAt(0,0,0);var r=Object(a.useState)(!1),i=Object(d.a)(r,2),u=i[0],s=i[1],c=Object(a.useState)(!1),l=Object(d.a)(c,2),h=l[0],v=l[1],M=Object(a.useState)(""),z=Object(d.a)(M,2),E=z[0],j=z[1],O=Object(a.useState)(0),y=Object(d.a)(O,2),S=y[0],k=y[1],C=Object(a.useState)(!0),N=Object(d.a)(C,2),x=N[0],T=N[1],L=Object(a.useState)(!1),R=Object(d.a)(L,2),W=R[0],Z=R[1],G=function(){w.render(b,n),Z(!1)},H=function(){n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),w.setSize(t.current.clientWidth,t.current.clientHeight),G()},X=function(e){v(!h),j(e.clientX||e.targetTouches[0].clientX)},A=function(){b.children[2]&&(v(!1),j(""),k(b.children[2].rotation.x||0))},q=function(e){h&&b.children[2]&&(T(!1),b.children[2].rotation.x=S+(E-(e.clientX||e.targetTouches[0].clientX))/500,G())},B=function(){W||(Z(!0),setTimeout(function(){b.children[2]&&(b.children[2].geometry.dispose(),b.children[2].material.dispose(),b.remove(b.children[2])),e.diamondSquare();var t=function(){if(0!==e.points.length){for(var t=new p.f(Math.pow(2,e.n)+1,Math.pow(2,e.n)+1,Math.pow(2,e.n),Math.pow(2,e.n)),n=[],a=0;a<e.points.length;a++)n.push.apply(n,Object(m.a)(e.points[a]));for(var o,r=0,i=[],s=0;s<t.attributes.position.array.length;s+=3)t.attributes.position.array[s+2]=n[r].z,n[r].z>=68?(i.push((170+Math.round(10*Math.random()))/255),i.push((170+Math.round(10*Math.random()))/255),i.push((170+Math.round(10*Math.random()))/255)):n[r].z>=46?(i.push(Math.round(109+2.5*(n[r].z-46)+20*Math.random())/255),i.push(Math.round(105+2.5*(n[r].z-46)+20*Math.random())/255),i.push(Math.round(105+2.5*(n[r].z-46)+20*Math.random())/255)):n[r].z>4?(i.push(Math.round(30+1.85*n[r].z)/255),i.push((Math.round(60+.9*n[r].z)+Math.round(20*Math.random()))/255),i.push(Math.round(30+1.7*n[r].z)/255)):n[r].z>0?(i.push(Math.round(90-14*n[r].z+10*Math.random())/255),i.push(Math.round(120-14*n[r].z+20*Math.random())/255),i.push(Math.round(90-14*n[r].z+10*Math.random())/255)):n[r].z>-2?(i.push(Math.round(180+20*Math.random())/255),i.push(Math.round(180+20*Math.random())/255),i.push(Math.round(130+20*Math.random())/255)):n[r].z>-22?(i.push(Math.round(70+3*(n[r].z+1.2))/255),i.push(Math.round(70+3*(n[r].z+1.2))/255),i.push(Math.round(90+3*(n[r].z+1.2))/255)):(i.push(8/255),i.push(8/255),i.push(28/255)),r+=1;return t.setAttribute("color",new p.b(i,3)),o=u?new p.d({color:"gray",flatShading:!0,dithering:!0,precision:"lowp"}):new p.d({vertexColors:p.i,flatShading:!0,shininess:1,dithering:!0,precision:"lowp"}),new p.c(t,o)}}();t.castShadow=!0,t.position.set(0,0,0),b.add(t),t.rotation.x=S,t.rotation.y=Math.PI/2,H()},0))};return Object(a.useEffect)(function(){w.setSize(t.current.clientWidth,t.current.clientHeight),window.addEventListener("resize",H),t.current.appendChild(w.domElement),B()},[]),Object(a.useEffect)(function(){n.fov=e.zoom,H()},[n,e.zoom]),o.a.createElement("div",{id:"generator"},o.a.createElement("div",{id:"canvas",ref:t,onMouseDown:X,onTouchStart:X,onMouseUp:A,onMouseOut:A,onMouseMove:q,onTouchMove:q,onTouchEnd:A},o.a.createElement("div",{className:"rotate-message-".concat(x)},o.a.createElement("h3",null,"Click and drag to rotate map")),o.a.createElement(f,{isLoading:W})),o.a.createElement(g,{grayscale:u,n:e.n,setN:e.setN,roughness:e.roughness,setRoughness:e.setRoughness,zoom:e.zoom,setZoom:e.setZoom,toggleGrayscale:function(){s(!u),b.children[2]&&(b.children[2].material=u?new p.d({vertexColors:p.i,color:"white",flatShading:!0,shininess:1,precision:"lowp"}):new p.d({color:"gray",flatShading:!0,shininess:1,precision:"lowp"})),G()},generateTerrain:B,isLoading:W}))}function E(){var e=Object(a.useState)(7),t=Object(d.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(.6),u=Object(d.a)(i,2),s=u[0],c=u[1],l=Object(a.useState)(14),h=Object(d.a)(l,2),m=h[0],p=h[1],g=Object(a.useState)([]),f=Object(d.a)(g,2),v=f[0],M=f[1],b=function(e,t,n,a){e=e.filter(function(e){return null!==e.z});for(var o,r=0,i=0;i<e.length;i++)r+=e[i].z;r/=e.length,o=Math.random()*a*s*.7,1===n&&(o*=.8),Math.random()<.5?r-=o:r+=o,t.z=r},w=function(){var e=[0,0,0,0];e.forEach(function(t,a){var o=Math.random()*n*2;Math.random()<.5?e[a]-=o:e[a]+=o});for(var t=function(e,t,a,o){for(var r=[],i=0;i<Math.pow(2,n)+1;i++){for(var u=[],s=0;s<Math.pow(2,n)+1;s++)u.push({z:null});r.push(u)}return r[0][0].z=e,r[r.length-1][0].z=t,r[r.length-1][r.length-1].z=a,r[0][r.length-1].z=o,r}.apply(void 0,e),a=1,o=t.length-1;a<2*n+1;){if(a%2!==0)for(var r=0;r<t.length;r+=o)for(var i=0;i<t[r].length&&!(i+o>=t[r].length||r+o>=t.length);i+=o){var u=[];u.push(t[r][i]),u.push(t[r][i+o]),u.push(t[r+o][i]),u.push(t[r+o][i+o]),b(u,t[Math.round(r+o/2)][Math.round(i+o/2)],a,o)}else for(var s=0;s<t.length;s+=o)for(var c=0;c<t[s].length;c+=o){var l=[];null===t[s][c].z&&(s-o>=0&&l.push(t[s-o][c]),c+o<t.length&&l.push(t[s][c+o]),s+o<t.length&&l.push(t[s+o][c]),c-o>=0&&l.push(t[s][c-o]),b(l,t[s][c],a,o))}a%2!==0&&(o/=2),o<1&&(o=1),a++}M(function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var a=E(e,t,n),o=a.reduce(function(e,t){return t+e})/a.length;e[t][n].z=o}return e}(t))},E=function(e,t,n){for(var a=[],o=t-1;o<=t+1;o++)if(!(o<0)){if(o>e.length-1)break;for(var r=n-1;r<=n+1;r++)r<0||o===t&&r===n||r>e.length-1||a.push(e[o][Math.round(r)].z)}return a};return Object(a.useEffect)(function(){w()},[n,s]),v.length>0?o.a.createElement(z,{n:n,roughness:s,zoom:m,points:v,diamondSquare:w,setN:r,setRoughness:c,setZoom:p}):null}w.setClearColor("rgb(50, 50, 50)");var j=function(e){function t(){return Object(u.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(E,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(j,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[13,1,2]]]);
//# sourceMappingURL=main.f7309c4b.chunk.js.map